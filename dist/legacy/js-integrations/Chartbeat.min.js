var Chartbeat_RS=function(e){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function r(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a,o,c,u,s;function f(){if(o)return a;o=1;var e=Object.prototype.toString;return a=function(n){switch(e.call(n)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}return null===n?"null":void 0===n?"undefined":n&&1===n.nodeType?"element":n===Object(n)?"object":t(n)}}function l(){if(u)return c;u=1;var e=/\b(Array|Date|Object|Math|JSON)\b/g;return c=function(t,n){var r=function(e){for(var t=[],n=0;n<e.length;n++)~t.indexOf(e[n])||t.push(e[n]);return t}(function(t){return t.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(e,"").match(/[a-zA-Z_]\w*/g)||[]}(t));return n&&"string"==typeof n&&(n=function(e){return function(t){return e+t}}(n)),n?function(e,t,n){var r=/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g;return e.replace(r,(function(e){return"("==e[e.length-1]||~t.indexOf(e)?n(e):e}))}(t,r,n):r},c}try{s=l()}catch(e){s=l()}var d=y;function y(e){switch({}.toString.call(e)){case"[object Object]":return function(e){var n={};for(var r in e)n[r]="string"==typeof e[r]?h(e[r]):y(e[r]);return function(e){if("object"!==t(e))return!1;for(var r in n){if(!(r in e))return!1;if(!n[r](e[r]))return!1}return!0}}(e);case"[object Function]":return e;case"[object String]":return/^ *\W+/.test(r=e)?new Function("_","return _ "+r):new Function("_","return "+function(e){var t,n,r,i=s(e);if(!i.length)return"_."+e;for(n=0;n<i.length;n++)e=g(r=i[n],e,t="('function' == typeof "+(t="_."+r)+" ? "+t+"() : "+t+")");return e}(r));case"[object RegExp]":return n=e,function(e){return n.test(e)};default:return h(e)}var n,r}function h(e){return function(t){return e===t}}function g(e,t,n){return t.replace(new RegExp("(\\.)?"+e,"g"),(function(e,t){return t?e:n}))}try{var b=f()}catch(e){b=f()}var p=d,v=Object.prototype.hasOwnProperty;function w(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e[r],r)}var m=function(e,t,n){switch(t=p(t),n=n||this,b(e)){case"array":return w(e,t,n);case"object":return"number"==typeof e.length?w(e,t,n):function(e,t,n){for(var r in e)v.call(e,r)&&t.call(n,r,e[r])}(e,t,n);case"string":return function(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e.charAt(r),r)}(e,t,n)}},_=!1,j=[],C=setInterval((function(){document.body&&(_=!0,m(j,E),clearInterval(C))}),5);function E(e){e(document.body)}var P,S=4,A=function(e){switch(e.toUpperCase()){case"INFO":S=1;break;case"DEBUG":S=2;break;case"WARN":S=3;break;default:S=4}},k=function(){var e;S<=2&&(e=console).log.apply(e,arguments)},O=1e3,R="CHARTBEAT";r(P={},R,R),r(P,"Chartbeat",R),r(P,"chartbeat",R),r(P,"Chart Beat",R),r(P,"chart beat",R);var F=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.logLevel&&A(n.logLevel),this.analytics=n,this._sf_async_config=window._sf_async_config=window._sf_async_config||{},window._sf_async_config.useCanonical=!0,window._sf_async_config.uid=t.uid,window._sf_async_config.domain=t.domain,this.isVideo=!!t.video,this.sendNameAndCategoryAsTitle=t.sendNameAndCategoryAsTitle||!0,this.subscriberEngagementKeys=t.subscriberEngagementKeys||[],this.replayEvents=[],this.failed=!1,this.isFirstPageCallMade=!1,this.name=R,this.areTransformationsConnected=r&&r.areTransformationsConnected,this.destinationId=r&&r.destinationId}var t,r,i;return t=e,r=[{key:"init",value:function(){k("===in init Chartbeat===")}},{key:"identify",value:function(e){k("in Chartbeat identify")}},{key:"track",value:function(e){k("in Chartbeat track")}},{key:"page",value:function(e){if(k("in Chartbeat page"),this.loadConfig(e),this.isFirstPageCallMade){if(this.failed)return k("===ignoring cause failed integration==="),void(this.replayEvents=[]);if(!this.isLoaded()&&!this.failed)return k("===pushing to replay queue for chartbeat==="),void this.replayEvents.push(["page",e]);k("===processing page event in chartbeat===");var t=e.message.properties;window.pSUPERFLY.virtualPage(t.path)}else this.isFirstPageCallMade=!0,this.initAfterPage()}},{key:"isLoaded",value:function(){return k("in Chartbeat isLoaded"),!this.isFirstPageCallMade||!!window.pSUPERFLY}},{key:"isFailed",value:function(){return this.failed}},{key:"isReady",value:function(){return!!window.pSUPERFLY}},{key:"loadConfig",value:function(e){var t,n=e.message.properties,r=n?n.category:void 0,i=e.message.name,a=n?n.author:void 0;this.sendNameAndCategoryAsTitle&&(t=r&&i?"".concat(r," ").concat(i):i),r&&(window._sf_async_config.sections=r),a&&(window._sf_async_config.authors=a),t&&(window._sf_async_config.title=t);var o=window._cbq=window._cbq||[];for(var c in n)n.hasOwnProperty(c)&&this.subscriberEngagementKeys.indexOf(c)>-1&&o.push([c,n[c]])}},{key:"initAfterPage",value:function(){var e,t=this;e=function(){var e,n,r=t.isVideo?"chartbeat_video.js":"chartbeat.js";e=document.createElement("script"),n=document.getElementsByTagName("script")[0],e.type="text/javascript",e.async=!0,e.src="//static.chartbeat.com/js/".concat(r),e.setAttribute("data-loader","RS_JS_SDK"),n.parentNode.insertBefore(e,n)},_?E(e):j.push(e),this._isReady(this).then((function(e){k("===replaying on chartbeat==="),e.replayEvents.forEach((function(t){e[t[0]](t[1])}))}))}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"_isReady",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return t.isLoaded()?(t.failed=!1,k("===chartbeat loaded successfully==="),e.analytics.emit("ready"),r(e)):n>=1e4?(t.failed=!0,k("===chartbeat failed==="),r(e)):void t.pause(O).then((function(){return t._isReady(e,n+O).then(r)}))}))}}],r&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();return e.Chartbeat=F,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=Chartbeat.min.js.map
