{"version":3,"file":"PostAffiliatePro.min.js","sources":["../../../node_modules/isobject/index.js","../../../node_modules/get-value/index.js","../../../src/integrations/PostAffiliatePro/utils.js","../../../src/utils/logUtil.js","../../../src/utils/errorHandler.js","../../../src/utils/constants.js","../../../src/utils/ScriptLoader.js","../../../src/integrations/PostAffiliatePro/constants.js","../../../src/integrations/PostAffiliatePro/browser.js"],"sourcesContent":["/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","/*!\n * get-value <https://github.com/jonschlinkert/get-value>\n *\n * Copyright (c) 2014-2018, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nconst isObject = require('isobject');\n\nmodule.exports = function(target, path, options) {\n  if (!isObject(options)) {\n    options = { default: options };\n  }\n\n  if (!isValidObject(target)) {\n    return typeof options.default !== 'undefined' ? options.default : target;\n  }\n\n  if (typeof path === 'number') {\n    path = String(path);\n  }\n\n  const isArray = Array.isArray(path);\n  const isString = typeof path === 'string';\n  const splitChar = options.separator || '.';\n  const joinChar = options.joinChar || (typeof splitChar === 'string' ? splitChar : '.');\n\n  if (!isString && !isArray) {\n    return target;\n  }\n\n  if (isString && path in target) {\n    return isValid(path, target, options) ? target[path] : options.default;\n  }\n\n  let segs = isArray ? path : split(path, splitChar, options);\n  let len = segs.length;\n  let idx = 0;\n\n  do {\n    let prop = segs[idx];\n    if (typeof prop === 'number') {\n      prop = String(prop);\n    }\n\n    while (prop && prop.slice(-1) === '\\\\') {\n      prop = join([prop.slice(0, -1), segs[++idx] || ''], joinChar, options);\n    }\n\n    if (prop in target) {\n      if (!isValid(prop, target, options)) {\n        return options.default;\n      }\n\n      target = target[prop];\n    } else {\n      let hasProp = false;\n      let n = idx + 1;\n\n      while (n < len) {\n        prop = join([prop, segs[n++]], joinChar, options);\n\n        if ((hasProp = prop in target)) {\n          if (!isValid(prop, target, options)) {\n            return options.default;\n          }\n\n          target = target[prop];\n          idx = n - 1;\n          break;\n        }\n      }\n\n      if (!hasProp) {\n        return options.default;\n      }\n    }\n  } while (++idx < len && isValidObject(target));\n\n  if (idx === len) {\n    return target;\n  }\n\n  return options.default;\n};\n\nfunction join(segs, joinChar, options) {\n  if (typeof options.join === 'function') {\n    return options.join(segs);\n  }\n  return segs[0] + joinChar + segs[1];\n}\n\nfunction split(path, splitChar, options) {\n  if (typeof options.split === 'function') {\n    return options.split(path);\n  }\n  return path.split(splitChar);\n}\n\nfunction isValid(key, target, options) {\n  if (typeof options.isValid === 'function') {\n    return options.isValid(key, target);\n  }\n  return true;\n}\n\nfunction isValidObject(val) {\n  return isObject(val) || Array.isArray(val) || typeof val === 'function';\n}\n","// This function helps to populate the sale object\nconst updateSaleObject = (sale, properties) => {\n  if (properties.total) sale.setTotalCost(properties.total);\n  if (properties.fixedCost) sale.setFixedCost(properties.fixedCost);\n  if (properties.order_id) sale.setOrderID(properties.order_id);\n  // Post Affiliate Pro supports five extra data only.\n  if (properties.data1) sale.setData1(properties.data1);\n  if (properties.data2) sale.setData2(properties.data2);\n  if (properties.data3) sale.setData3(properties.data3);\n  if (properties.data4) sale.setData4(properties.data4);\n  if (properties.data5) sale.setData5(properties.data5);\n  if (properties.doNotDeleteCookies && properties.doNotDeleteCookies === true)\n    sale.doNotDeleteCookies();\n  if (properties.status) sale.setStatus(properties.status);\n  if (properties.currency) sale.setCurrency(properties.currency);\n  if (properties.customCommision) sale.setCustomCommission(properties.customCommision);\n  if (properties.channel) sale.setChannelID(properties.channel);\n  if (properties.coupon) sale.setCoupon(properties.coupon);\n  if (properties.campaignId) sale.setCampaignID(properties.campaignId);\n  if (properties.affiliateId) sale.setAffiliateID(properties.affiliateId);\n};\nexport default updateSaleObject;\n","const LOG_LEVEL_INFO = 1;\nconst LOG_LEVEL_DEBUG = 2;\nconst LOG_LEVEL_WARN = 3;\nconst LOG_LEVEL_ERROR = 4;\nconst DEF_LOG_LEVEL = LOG_LEVEL_ERROR;\nlet LOG_LEVEL = DEF_LOG_LEVEL;\n\nconst logger = {\n  setLogLevel(logLevel) {\n    switch (logLevel.toUpperCase()) {\n      case 'INFO':\n        LOG_LEVEL = LOG_LEVEL_INFO;\n        break;\n      case 'DEBUG':\n        LOG_LEVEL = LOG_LEVEL_DEBUG;\n        break;\n      case 'WARN':\n        LOG_LEVEL = LOG_LEVEL_WARN;\n        break;\n      default:\n        LOG_LEVEL = DEF_LOG_LEVEL;\n        break;\n    }\n  },\n\n  info(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_INFO) {\n      console.info(...args);\n    }\n  },\n\n  debug(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_DEBUG) {\n      console.log(...args);\n    }\n  },\n\n  warn(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_WARN) {\n      console.warn(...args);\n    }\n  },\n\n  error(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_ERROR) {\n      console.error(...args);\n    }\n  },\n};\n\nexport default logger;\n","import logger from './logUtil';\nimport { LOAD_ORIGIN, ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME } from './constants';\n\n/**\n * This function is to send handled errors to available error reporting client\n *\n * @param {Error} error Error instance from handled error\n */\nfunction notifyError(error) {\n  const errorReportingClient =\n    window.rudderanalytics && window.rudderanalytics[ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME];\n\n  if (errorReportingClient) {\n    errorReportingClient.notify(error);\n  }\n}\n\nfunction normaliseError(error, customMessage, analyticsInstance) {\n  let errorMessage;\n  try {\n    if (typeof error === 'string') {\n      errorMessage = error;\n    } else if (error instanceof Error) {\n      errorMessage = error.message;\n    } else {\n      errorMessage = error.message ? error.message : JSON.stringify(error);\n    }\n  } catch (e) {\n    errorMessage = '';\n  }\n\n  if (error instanceof Event) {\n    // Discard all the non-script loading errors\n    if (error.target && error.target.localName !== 'script') {\n      return '';\n    }\n\n    // Discard script errors that are not originated at SDK or from native SDKs\n    if (\n      error.target.dataset &&\n      (error.target.dataset.loader !== LOAD_ORIGIN ||\n        error.target.dataset.isNonNativeSDK !== 'true')\n    )\n      return '';\n\n    errorMessage = `error in script loading:: src::  ${error.target.src} id:: ${error.target.id}`;\n\n    // SDK triggered ad-blocker script\n    if (error.target.id === 'ad-block') {\n      analyticsInstance.page(\n        'RudderJS-Initiated',\n        'ad-block page request',\n        { path: '/ad-blocked', title: errorMessage },\n        analyticsInstance.sendAdblockPageOptions,\n      );\n      // No need to proceed further for Ad-block errors\n      return '';\n    }\n  }\n\n  const customErrMessagePrefix = customMessage || '';\n  return `[handleError]::${customErrMessagePrefix} \"${errorMessage}\"`;\n}\n\nfunction handleError(error, customMessage, analyticsInstance) {\n  let errorMessage;\n\n  try {\n    errorMessage = normaliseError(error, customMessage, analyticsInstance);\n  } catch (err) {\n    logger.error('[handleError] Exception:: ', err);\n    logger.error('[handleError] Original error:: ', JSON.stringify(error));\n    notifyError(err);\n  }\n\n  if (!errorMessage) {\n    return;\n  }\n\n  logger.error(errorMessage);\n  let errorObj = error;\n  if (!(error instanceof Error)) errorObj = new Error(errorMessage);\n  notifyError(errorObj);\n}\n\nexport { notifyError, handleError, normaliseError };\n","// Reserved Keywords for properties/traits\nconst RESERVED_KEYS = [\n  'anonymous_id',\n  'id',\n  'sent_at',\n  'received_at',\n  'timestamp',\n  'original_timestamp',\n  'event_text',\n  'event',\n];\n\nconst CONFIG_URL =\n  'https://api.rudderlabs.com/sourceConfig/?p=__MODULE_TYPE__&v=__PACKAGE_VERSION__';\nconst SDK_CDN_BASE_URL = 'https://cdn.rudderlabs.com';\nconst CDN_ARCH_VERSION_DIR = 'v1.1';\nconst CDN_INT_DIR = 'js-integrations';\nconst DEST_SDK_BASE_URL = `${SDK_CDN_BASE_URL}/${CDN_ARCH_VERSION_DIR}/${CDN_INT_DIR}`;\n\nconst MAX_WAIT_FOR_INTEGRATION_LOAD = 10000;\nconst INTEGRATION_LOAD_CHECK_INTERVAL = 1000;\nconst INTG_SUFFIX = '_RS';\nconst POLYFILL_URL =\n  'https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.find%2CArray.prototype.includes%2CPromise%2CString.prototype.endsWith%2CString.prototype.includes%2CString.prototype.startsWith%2CObject.entries%2CObject.values%2CElement.prototype.dataset%2CString.prototype.replaceAll';\n\nconst GENERIC_TRUE_VALUES = ['true', 'True', 'TRUE', 't', 'T', '1'];\nconst GENERIC_FALSE_VALUES = ['false', 'False', 'FALSE', 'f', 'F', '0'];\n\nconst SAMESITE_COOKIE_OPTS = ['Lax', 'None', 'Strict'];\n\nconst DEFAULT_SESSION_TIMEOUT = 30 * 60 * 1000; // 30 min in milliseconds\nconst MIN_SESSION_TIMEOUT = 10 * 1000; // 10 sec in milliseconds\nconst MIN_SESSION_ID_LENGTH = 10;\n\nconst ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME = 'errorReporting';\nconst LOAD_ORIGIN = 'RS_JS_SDK';\n\nconst DEFAULT_REGION = 'US';\nconst DEFAULT_DATAPLANE_URL = 'https://hosted.rudderlabs.com';\n\nconst RESIDENCY_SERVERS = [DEFAULT_REGION, 'EU'];\n\nconst SUPPORTED_CONSENT_MANAGERS = ['oneTrust'];\n\nconst SYSTEM_KEYWORDS = ['library', 'consentManagement'];\nconst UA_CH_LEVELS = ['none', 'default', 'full'];\n\nexport {\n  RESERVED_KEYS,\n  CONFIG_URL,\n  SDK_CDN_BASE_URL,\n  CDN_ARCH_VERSION_DIR,\n  CDN_INT_DIR,\n  DEST_SDK_BASE_URL,\n  MAX_WAIT_FOR_INTEGRATION_LOAD,\n  INTEGRATION_LOAD_CHECK_INTERVAL,\n  INTG_SUFFIX,\n  POLYFILL_URL,\n  GENERIC_TRUE_VALUES,\n  GENERIC_FALSE_VALUES,\n  SAMESITE_COOKIE_OPTS,\n  DEFAULT_SESSION_TIMEOUT,\n  MIN_SESSION_TIMEOUT,\n  MIN_SESSION_ID_LENGTH,\n  ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME,\n  LOAD_ORIGIN,\n  DEFAULT_REGION,\n  DEFAULT_DATAPLANE_URL,\n  RESIDENCY_SERVERS,\n  SUPPORTED_CONSENT_MANAGERS,\n  SYSTEM_KEYWORDS,\n  UA_CH_LEVELS,\n};\n","/* eslint-disable no-use-before-define */\n// import logger from \"../utils/logUtil\";\n\nimport { handleError } from \"./errorHandler\";\n\nconst defaultAsyncState = true;\n\nexport const LOAD_ORIGIN = 'RS_JS_SDK';\n/**\n * Script loader\n * @param {String} id                               Id of the script\n * @param {String} src                              URL of the script\n * @param {Object} options                          Object containing different configuration\n * @param {Boolean} options.async                   Determines script will be loaded asynchronously or not\n * @param {Boolean} options.isNonNativeSDK          Determines whether the script that will be loaded is one of RS's own\n * @param {Boolean} options.skipDatasetAttributes   Determines whether to add or skip dataset attribute\n */\nconst ScriptLoader = (id, src, options = {}) => {\n  try {\n    const exists = document.getElementById(id);\n    if (exists) {\n      // logger.debug(\"script already loaded\");\n      return;\n    }\n\n    const js = document.createElement('script');\n    js.src = src;\n    js.async = options.async === undefined ? defaultAsyncState : options.async;\n    js.type = 'text/javascript';\n    js.id = id;\n    // This checking is in place to skip the dataset attribute for some cases(while loading polyfill)\n    if (options.skipDatasetAttributes !== true) {\n      js.setAttribute('data-loader', LOAD_ORIGIN);\n      if (options.isNonNativeSDK !== undefined) {\n        js.setAttribute('data-isNonNativeSDK', options.isNonNativeSDK);\n      }\n    }\n    const headElmColl = document.getElementsByTagName('head');\n    if (headElmColl.length > 0) {\n      // logger.debug(\"==adding script==\", js);\n      headElmColl[0].insertBefore(js, headElmColl[0].firstChild);\n    } else {\n      const e = document.getElementsByTagName('script')[0];\n      // logger.debug(\"==parent script==\", e);\n      // logger.debug(\"==adding script==\", js);\n      e.parentNode.insertBefore(js, e);\n    }\n  } catch (e) {\n    handleError(e);\n  }\n};\n\nexport default ScriptLoader;\n","const NAME = 'POST_AFFILIATE_PRO';\nconst CNameMapping = {\n  [NAME]: NAME,\n  PostAffiliatePro: NAME,\n  Post_affiliate_pro: NAME,\n  'Post Affiliate Pro': NAME,\n  'Post affiliate pro': NAME,\n  'post affiliate pro': NAME,\n  postaffiliatepro: NAME,\n  POSTAFFILIATEPRO: NAME,\n};\n\nexport { NAME, CNameMapping };\n","/* eslint-disable class-methods-use-this */\n/* eslint-disable no-underscore-dangle */\nimport get from 'get-value';\nimport updateSaleObject from './utils';\nimport ScriptLoader from '../../utils/ScriptLoader';\nimport logger from '../../utils/logUtil';\nimport { NAME } from './constants';\n\nclass PostAffiliatePro {\n  constructor(config, analytics, destinationInfo) {\n    if (analytics.logLevel) {\n      logger.setLogLevel(analytics.logLevel);\n    }\n    this.name = NAME;\n    this.url = config.url;\n    this.mergeProducts = config.mergeProducts;\n    this.accountId = config.accountId;\n    this.affLinkId = config.affLinkId;\n    this.idName = config.idName;\n    this.cookieLinkId = config.cookieLinkId;\n    this.cookieName = config.cookieName;\n    this.affiliateToCustomField = config.affiliateToCustomField;\n    this.campaignToCustomField = config.campaignToCustomField;\n    this.cookieDomain = config.cookieDomain;\n    this.cookieToCustomField = config.cookieToCustomField;\n    this.disableTrackingMethod = config.disableTrackingMethod;\n    this.paramNameUserId = config.paramNameUserId;\n    this.clickEvents = config.clickEvents;\n    this.areTransformationsConnected = destinationInfo && destinationInfo.areTransformationsConnected;\n    this.destinationId = destinationInfo && destinationInfo.destinationId;\n  }\n\n  init() {\n    logger.debug('===in init Post Affiliate Pro===');\n    if (!this.url) {\n      logger.debug('URL is missing');\n      return;\n    }\n    ScriptLoader('pap_x2s6df8d', this.url);\n  }\n\n  isLoaded() {\n    logger.debug('===In isLoaded Post Affiliate Pro===');\n    return !!window.PostAffTracker;\n  }\n\n  isReady() {\n    logger.debug('===In isReady Post Affiliate Pro===');\n\n    if (window.PostAffTracker) {\n      if (!this.disableTrackingMethod) window.PostAffTracker.disableTrackingMethod('F');\n      if (this.paramNameUserId) window.PostAffTracker.setParamNameUserId(this.paramNameUserId);\n      if (this.accountId) window.PostAffTracker.setAccountId(this.accountId);\n      if (this.cookieDomain) window.PostAffTracker.setCookieDomain(this.cookieDomain);\n      if (this.cookieToCustomField)\n        window.PostAffTracker.writeCookieToCustomField(this.cookieToCustomField);\n      if (this.affiliateToCustomField)\n        window.PostAffTracker.writeAffiliateToCustomField(this.affiliateToCustomField);\n      if (this.campaignToCustomField)\n        window.PostAffTracker.writeCampaignToCustomField(this.campaignToCustomField);\n      if (this.affLinkId && this.idName)\n        window.PostAffTracker.writeAffiliateToLink(this.affLinkId, this.idName);\n      if (this.cookieName && this.cookieLinkId)\n        window.PostAffTracker.writeCookieToLink(this.cookieLinkId, this.cookieName);\n      return true;\n    }\n    return false;\n  }\n\n  identify(rudderElement) {\n    logger.debug('===In Post Affiliate Pro identify===');\n    const { message } = rudderElement;\n    const visitorId = get(message, 'userId');\n    window.PostAffTracker.setVisitorId(visitorId);\n  }\n  // eslint-disable-next-line lines-between-class-members\n  track(rudderElement) {\n    logger.debug('===In Post Affiliate Pro track===');\n    const clickEventsArr = this.clickEvents ? this.clickEvents.split(',') : null;\n    const { message } = rudderElement;\n    const { event } = message;\n    const { properties } = message;\n    // We are going to call click event, for the event list given in dashboard only.\n    if (clickEventsArr && clickEventsArr.includes(event)) {\n      if (properties) {\n        if (properties.data1) window.Data1 = properties.data1;\n        if (properties.data2) window.Data2 = properties.data2;\n        if (properties.affiliateId) window.AffiliateID = properties.affiliateId;\n        if (properties.bannerId) window.BannerID = properties.bannerId;\n        if (properties.campaignId) window.CampaignID = properties.campaignId;\n        if (properties.channel) window.Channel = properties.channel;\n      }\n      window.PostAffTracker.track();\n    }\n    // We are supporting only one event for sale.\n    if (event === 'Order Completed') {\n      const productsArr = properties && properties.products ? properties.products : null;\n      if (productsArr) {\n        if (this.mergeProducts) {\n          window.sale = window.PostAffTracker.createSale();\n          if (window.sale) updateSaleObject(window.sale, properties);\n          const mergedProductId = [];\n          for (let i = 0; i < productsArr.length; i += 1)\n            if (productsArr[i].product_id) mergedProductId.push(productsArr[i].product_id);\n          const merged = mergedProductId.join();\n          if (merged) window.sale.setProductID(merged);\n        } else {\n          for (let i = 0; i < productsArr.length; i += 1) {\n            window[`sale${i}`] = window.PostAffTracker.createSale();\n            updateSaleObject(window[`sale${i}`], properties);\n            if (productsArr[i].product_id)\n              window[`sale${i}`].setProductID(productsArr[i].product_id);\n          }\n        }\n      } else {\n        // If any product is not available.\n        window.sale = window.PostAffTracker.createSale();\n      }\n      window.PostAffTracker.register();\n    }\n  }\n\n  // reset() {\n  //   window.PostAffTracker.setVisitorId(null);\n  // }\n}\nexport default PostAffiliatePro;\n"],"names":["isObject","val","_typeof","Array","isArray","join","segs","joinChar","options","isValid","key","target","isValidObject","updateSaleObject","sale","properties","total","setTotalCost","fixedCost","setFixedCost","order_id","setOrderID","data1","setData1","data2","setData2","data3","setData3","data4","setData4","data5","setData5","doNotDeleteCookies","status","setStatus","currency","setCurrency","customCommision","setCustomCommission","channel","setChannelID","coupon","setCoupon","campaignId","setCampaignID","affiliateId","setAffiliateID","LOG_LEVEL","logger","logLevel","toUpperCase","_console2","console","log","apply","arguments","_console4","error","notifyError","errorReportingClient","window","rudderanalytics","notify","handleError","customMessage","analyticsInstance","errorMessage","Error","message","JSON","stringify","e","Event","localName","dataset","loader","isNonNativeSDK","concat","src","id","page","path","title","sendAdblockPageOptions","normaliseError","err","errorObj","_CNameMapping","LOAD_ORIGIN","NAME","_defineProperty","PostAffiliatePro","config","analytics","destinationInfo","_classCallCheck","this","name","url","mergeProducts","accountId","affLinkId","idName","cookieLinkId","cookieName","affiliateToCustomField","campaignToCustomField","cookieDomain","cookieToCustomField","disableTrackingMethod","paramNameUserId","clickEvents","areTransformationsConnected","destinationId","value","length","undefined","document","getElementById","js","createElement","async","type","skipDatasetAttributes","setAttribute","headElmColl","getElementsByTagName","insertBefore","firstChild","parentNode","ScriptLoader","PostAffTracker","setParamNameUserId","setAccountId","setCookieDomain","writeCookieToCustomField","writeAffiliateToCustomField","writeCampaignToCustomField","writeAffiliateToLink","writeCookieToLink","rudderElement","visitorId","default","String","isString","splitChar","separator","split","len","idx","prop","slice","hasProp","n","get","setVisitorId","clickEventsArr","event","includes","Data1","Data2","AffiliateID","bannerId","BannerID","CampaignID","Channel","track","productsArr","products","createSale","mergedProductId","i","product_id","push","merged","setProductID","register"],"mappings":"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"}