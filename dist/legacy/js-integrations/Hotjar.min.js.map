{"version":3,"file":"Hotjar.min.js","sources":["../../../src/utils/logUtil.js","../../../src/integrations/Hotjar/constants.js","../../../src/integrations/Hotjar/browser.js","../../../src/utils/ScriptLoader.js"],"sourcesContent":["const LOG_LEVEL_INFO = 1;\nconst LOG_LEVEL_DEBUG = 2;\nconst LOG_LEVEL_WARN = 3;\nconst LOG_LEVEL_ERROR = 4;\nconst DEF_LOG_LEVEL = LOG_LEVEL_ERROR;\nlet LOG_LEVEL = DEF_LOG_LEVEL;\n\nconst logger = {\n  setLogLevel(logLevel) {\n    switch (logLevel.toUpperCase()) {\n      case 'INFO':\n        LOG_LEVEL = LOG_LEVEL_INFO;\n        break;\n      case 'DEBUG':\n        LOG_LEVEL = LOG_LEVEL_DEBUG;\n        break;\n      case 'WARN':\n        LOG_LEVEL = LOG_LEVEL_WARN;\n        break;\n      default:\n        LOG_LEVEL = DEF_LOG_LEVEL;\n        break;\n    }\n  },\n\n  info(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_INFO) {\n      console.info(...args);\n    }\n  },\n\n  debug(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_DEBUG) {\n      console.log(...args);\n    }\n  },\n\n  warn(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_WARN) {\n      console.warn(...args);\n    }\n  },\n\n  error(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_ERROR) {\n      console.error(...args);\n    }\n  },\n};\n\nexport default logger;\n","const NAME = 'HOTJAR';\nconst CNameMapping = {\n  [NAME]: NAME,\n  Hotjar: NAME,\n  hotjar: NAME,\n  'Hot Jar': NAME,\n  'hot jar': NAME,\n};\n\nexport { NAME, CNameMapping };\n","/* eslint-disable no-underscore-dangle */\n/* eslint-disable class-methods-use-this */\nimport logger from '../../utils/logUtil';\nimport { LOAD_ORIGIN } from '../../utils/ScriptLoader';\nimport { NAME } from './constants';\n\nclass Hotjar {\n  constructor(config, analytics, destinationInfo) {\n    if (analytics.logLevel) {\n      logger.setLogLevel(analytics.logLevel);\n    }\n    this.siteId = config.siteID;\n    this.name = NAME;\n    this._ready = false;\n    this.areTransformationsConnected = destinationInfo && destinationInfo.areTransformationsConnected;\n    this.destinationId = destinationInfo && destinationInfo.destinationId;\n  }\n\n  init() {\n    logger.debug('===In init Hotjar===');\n\n    window.hotjarSiteId = this.siteId;\n    (function (h, o, t, j, a, r) {\n      h.hj =\n        h.hj ||\n        function () {\n          (h.hj.q = h.hj.q || []).push(arguments);\n        };\n      h._hjSettings = { hjid: h.hotjarSiteId, hjsv: 6 };\n      a = o.getElementsByTagName('head')[0];\n      r = o.createElement('script');\n      r.setAttribute('data-loader', LOAD_ORIGIN);\n      r.async = 1;\n      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;\n      a.appendChild(r);\n    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');\n    this._ready = true;\n  }\n\n  identify(rudderElement) {\n    logger.debug('===In Hotjar identify===');\n\n    const userId = rudderElement.message.userId || rudderElement.message.anonymousId;\n    if (!userId) {\n      logger.debug('[Hotjar] identify:: user id is required');\n      return;\n    }\n\n    const { traits } = rudderElement.message.context;\n\n    window.hj('identify', rudderElement.message.userId, traits);\n  }\n\n  track(rudderElement) {\n    logger.debug('===In Hotjar track===');\n\n    const { event } = rudderElement.message;\n\n    if (!event) {\n      logger.error('Event name not present');\n      return;\n    }\n\n    // event name must not exceed 750 characters and can only contain alphanumeric, underscores, and dashes.\n    // Ref - https://help.hotjar.com/hc/en-us/articles/4405109971095#the-events-api-call\n    window.hj('event', event.replace(/\\s\\s+/g, ' ').substring(0, 750).replaceAll(' ', '_'));\n  }\n\n  page() {\n    logger.debug('===In Hotjar page===');\n    logger.debug('[Hotjar] page:: method not supported');\n  }\n\n  isLoaded() {\n    logger.debug('===In isLoaded Hotjar===');\n    return this._ready;\n  }\n\n  isReady() {\n    logger.debug('===In isReady Hotjar===');\n    return this._ready;\n  }\n}\n\nexport { Hotjar };\n","/* eslint-disable no-use-before-define */\n// import logger from \"../utils/logUtil\";\n\nimport { handleError } from \"./errorHandler\";\n\nconst defaultAsyncState = true;\n\nexport const LOAD_ORIGIN = 'RS_JS_SDK';\n/**\n * Script loader\n * @param {String} id                               Id of the script\n * @param {String} src                              URL of the script\n * @param {Object} options                          Object containing different configuration\n * @param {Boolean} options.async                   Determines script will be loaded asynchronously or not\n * @param {Boolean} options.isNonNativeSDK          Determines whether the script that will be loaded is one of RS's own\n * @param {Boolean} options.skipDatasetAttributes   Determines whether to add or skip dataset attribute\n */\nconst ScriptLoader = (id, src, options = {}) => {\n  try {\n    const exists = document.getElementById(id);\n    if (exists) {\n      // logger.debug(\"script already loaded\");\n      return;\n    }\n\n    const js = document.createElement('script');\n    js.src = src;\n    js.async = options.async === undefined ? defaultAsyncState : options.async;\n    js.type = 'text/javascript';\n    js.id = id;\n    // This checking is in place to skip the dataset attribute for some cases(while loading polyfill)\n    if (options.skipDatasetAttributes !== true) {\n      js.setAttribute('data-loader', LOAD_ORIGIN);\n      if (options.isNonNativeSDK !== undefined) {\n        js.setAttribute('data-isNonNativeSDK', options.isNonNativeSDK);\n      }\n    }\n    const headElmColl = document.getElementsByTagName('head');\n    if (headElmColl.length > 0) {\n      // logger.debug(\"==adding script==\", js);\n      headElmColl[0].insertBefore(js, headElmColl[0].firstChild);\n    } else {\n      const e = document.getElementsByTagName('script')[0];\n      // logger.debug(\"==parent script==\", e);\n      // logger.debug(\"==adding script==\", js);\n      e.parentNode.insertBefore(js, e);\n    }\n  } catch (e) {\n    handleError(e);\n  }\n};\n\nexport default ScriptLoader;\n"],"names":["LOG_LEVEL","logger","logLevel","toUpperCase","_console2","console","log","apply","arguments","_console4","error","NAME","_defineProperty","_CNameMapping","Hotjar","config","analytics","destinationInfo","_classCallCheck","this","siteId","siteID","name","_ready","areTransformationsConnected","destinationId","key","value","h","o","a","r","window","hotjarSiteId","document","hj","q","push","_hjSettings","hjid","hjsv","getElementsByTagName","createElement","setAttribute","async","src","appendChild","rudderElement","message","userId","anonymousId","traits","context","event","replace","substring","replaceAll"],"mappings":"2pBAAA,MAKIA,EAFoB,EAIlBC,EACO,SAACC,GACV,OAAQA,EAASC,eACf,IAAK,OACHH,EAXe,EAYf,MACF,IAAK,QACHA,EAbgB,EAchB,MACF,IAAK,OACHA,EAfe,EAgBf,MACF,QACEA,EAjBgB,EAoBtB,EAhBIC,EAwBC,WAC+B,IAAAG,EAA9BJ,GA/BgB,IAgClBI,EAAAC,SAAQC,IAAGC,MAAAH,EAAAI,UAEf,EA5BIP,aAqCgC,IAAAQ,EAA9BT,GAzCgB,IA0ClBS,EAAAJ,SAAQK,MAAKH,MAAAE,EAAAD,UAEjB,EC/CIG,EAAO,SACKC,EAAAC,EAAAD,CAAAA,EACfD,EAAOA,GAAIC,EAAAC,EACJF,SAAAA,GAAIC,EAAAC,EAAA,SACJF,GAAIC,EAAAC,EACZ,UAAWF,GAAIC,EAAAC,EACf,UAAWF,GCAP,IAAAG,EAAM,WACV,SAAAA,EAAYC,EAAQC,EAAWC,gGAAiBC,CAAAJ,KAAAA,GAC1CE,EAAUd,UACZD,EAAmBe,EAAUd,UAE/BiB,KAAKC,OAASL,EAAOM,OACrBF,KAAKG,KAAOX,EACZQ,KAAKI,QAAS,EACdJ,KAAKK,4BAA8BP,GAAmBA,EAAgBO,4BACtEL,KAAKM,cAAgBR,GAAmBA,EAAgBQ,aAC1D,WAiECX,SAjEAA,IAAA,CAAA,CAAAY,IAAAC,OAAAA,MAED,WAIE,IAAWC,EAAGC,EAASC,EAAGC,EAH1B9B,EAAa,wBAEb+B,OAAOC,aAAed,KAAKC,OAChBQ,EAaRI,OAbWH,EAaHK,SAZTN,EAAEO,GACAP,EAAEO,IACF,YACGP,EAAEO,GAAGC,EAAIR,EAAEO,GAAGC,GAAK,IAAIC,KAAK7B,UAC/B,EACFoB,EAAEU,YAAc,CAAEC,KAAMX,EAAEK,aAAcO,KAAM,GAC9CV,EAAID,EAAEY,qBAAqB,QAAQ,IACnCV,EAAIF,EAAEa,cAAc,WAClBC,aAAa,cCxBM,aDyBrBZ,EAAEa,MAAQ,EACVb,EAAEc,IAEiB,sCAFPjB,EAAEU,YAAYC,KAEgC,UAFrBX,EAAEU,YAAYE,KACnDV,EAAEgB,YAAYf,GAEhBZ,KAAKI,QAAS,CAChB,IAACG,IAAA,WAAAC,MAED,SAASoB,GAIP,GAHA9C,EAAa,4BAEE8C,EAAcC,QAAQC,QAAUF,EAAcC,QAAQE,YACrE,CAKA,IAAQC,EAAWJ,EAAcC,QAAQI,QAAjCD,OAERnB,OAAOG,GAAG,WAAYY,EAAcC,QAAQC,OAAQE,EAJpD,MAFElD,EAAa,0CAOjB,IAACyB,IAAA,QAAAC,MAED,SAAMoB,GACJ9C,EAAa,yBAEb,IAAQoD,EAAUN,EAAcC,QAAxBK,MAEHA,EAOLrB,OAAOG,GAAG,QAASkB,EAAMC,QAAQ,SAAU,KAAKC,UAAU,EAAG,KAAKC,WAAW,IAAK,MANhFvD,EAAa,yBAOjB,IAACyB,IAAA,OAAAC,MAED,WACE1B,EAAa,wBACbA,EAAa,uCACf,IAACyB,IAAA,WAAAC,MAED,WAEE,OADA1B,EAAa,4BACFkB,KAACI,MACd,GAAC,CAAAG,IAAAC,UAAAA,MAED,WAEE,OADA1B,EAAa,2BACFkB,KAACI,MACd,qFAACT,CAGH,CA9EY"}