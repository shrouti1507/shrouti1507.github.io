{"version":3,"file":"Mouseflow.min.js","sources":["../../../src/integrations/Mouseflow/constants.js","../../../src/utils/logUtil.js","../../../src/utils/errorHandler.js","../../../src/utils/constants.js","../../../src/utils/ScriptLoader.js","../../../node_modules/isobject/index.js","../../../node_modules/get-value/index.js","../../../src/integrations/Mouseflow/utils.js","../../../src/integrations/Mouseflow/browser.js"],"sourcesContent":["const NAME = 'MOUSEFLOW';\nconst CNameMapping = {\n  [NAME]: NAME,\n  Mouseflow: NAME,\n  mouseflow: NAME,\n  mouseFlow: NAME,\n  MouseFlow: NAME,\n  'Mouse flow': NAME,\n  'mouse flow': NAME,\n  'mouse Flow': NAME,\n  'Mouse Flow': NAME,\n};\n\nexport { NAME, CNameMapping };\n","const LOG_LEVEL_INFO = 1;\nconst LOG_LEVEL_DEBUG = 2;\nconst LOG_LEVEL_WARN = 3;\nconst LOG_LEVEL_ERROR = 4;\nconst DEF_LOG_LEVEL = LOG_LEVEL_ERROR;\nlet LOG_LEVEL = DEF_LOG_LEVEL;\n\nconst logger = {\n  setLogLevel(logLevel) {\n    switch (logLevel.toUpperCase()) {\n      case 'INFO':\n        LOG_LEVEL = LOG_LEVEL_INFO;\n        break;\n      case 'DEBUG':\n        LOG_LEVEL = LOG_LEVEL_DEBUG;\n        break;\n      case 'WARN':\n        LOG_LEVEL = LOG_LEVEL_WARN;\n        break;\n      default:\n        LOG_LEVEL = DEF_LOG_LEVEL;\n        break;\n    }\n  },\n\n  info(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_INFO) {\n      console.info(...args);\n    }\n  },\n\n  debug(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_DEBUG) {\n      console.log(...args);\n    }\n  },\n\n  warn(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_WARN) {\n      console.warn(...args);\n    }\n  },\n\n  error(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_ERROR) {\n      console.error(...args);\n    }\n  },\n};\n\nexport default logger;\n","import logger from './logUtil';\nimport { LOAD_ORIGIN, ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME } from './constants';\n\n/**\n * This function is to send handled errors to available error reporting client\n *\n * @param {Error} error Error instance from handled error\n */\nfunction notifyError(error) {\n  const errorReportingClient =\n    window.rudderanalytics && window.rudderanalytics[ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME];\n\n  if (errorReportingClient) {\n    errorReportingClient.notify(error);\n  }\n}\n\nfunction normaliseError(error, customMessage, analyticsInstance) {\n  let errorMessage;\n  try {\n    if (typeof error === 'string') {\n      errorMessage = error;\n    } else if (error instanceof Error) {\n      errorMessage = error.message;\n    } else {\n      errorMessage = error.message ? error.message : JSON.stringify(error);\n    }\n  } catch (e) {\n    errorMessage = '';\n  }\n\n  if (error instanceof Event) {\n    // Discard all the non-script loading errors\n    if (error.target && error.target.localName !== 'script') {\n      return '';\n    }\n\n    // Discard script errors that are not originated at SDK or from native SDKs\n    if (\n      error.target.dataset &&\n      (error.target.dataset.loader !== LOAD_ORIGIN ||\n        error.target.dataset.isNonNativeSDK !== 'true')\n    )\n      return '';\n\n    errorMessage = `error in script loading:: src::  ${error.target.src} id:: ${error.target.id}`;\n\n    // SDK triggered ad-blocker script\n    if (error.target.id === 'ad-block') {\n      analyticsInstance.page(\n        'RudderJS-Initiated',\n        'ad-block page request',\n        { path: '/ad-blocked', title: errorMessage },\n        analyticsInstance.sendAdblockPageOptions,\n      );\n      // No need to proceed further for Ad-block errors\n      return '';\n    }\n  }\n\n  const customErrMessagePrefix = customMessage || '';\n  return `[handleError]::${customErrMessagePrefix} \"${errorMessage}\"`;\n}\n\nfunction handleError(error, customMessage, analyticsInstance) {\n  let errorMessage;\n\n  try {\n    errorMessage = normaliseError(error, customMessage, analyticsInstance);\n  } catch (err) {\n    logger.error('[handleError] Exception:: ', err);\n    logger.error('[handleError] Original error:: ', JSON.stringify(error));\n    notifyError(err);\n  }\n\n  if (!errorMessage) {\n    return;\n  }\n\n  logger.error(errorMessage);\n  let errorObj = error;\n  if (!(error instanceof Error)) errorObj = new Error(errorMessage);\n  notifyError(errorObj);\n}\n\nexport { notifyError, handleError, normaliseError };\n","// Reserved Keywords for properties/traits\nconst RESERVED_KEYS = [\n  'anonymous_id',\n  'id',\n  'sent_at',\n  'received_at',\n  'timestamp',\n  'original_timestamp',\n  'event_text',\n  'event',\n];\n\nconst CONFIG_URL =\n  'https://api.rudderlabs.com/sourceConfig/?p=__MODULE_TYPE__&v=__PACKAGE_VERSION__';\nconst SDK_CDN_BASE_URL = 'https://cdn.rudderlabs.com';\nconst CDN_ARCH_VERSION_DIR = 'v1.1';\nconst CDN_INT_DIR = 'js-integrations';\nconst DEST_SDK_BASE_URL = `${SDK_CDN_BASE_URL}/${CDN_ARCH_VERSION_DIR}/${CDN_INT_DIR}`;\n\nconst MAX_WAIT_FOR_INTEGRATION_LOAD = 10000;\nconst INTEGRATION_LOAD_CHECK_INTERVAL = 1000;\nconst INTG_SUFFIX = '_RS';\nconst POLYFILL_URL =\n  'https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.find%2CArray.prototype.includes%2CPromise%2CString.prototype.endsWith%2CString.prototype.includes%2CString.prototype.startsWith%2CObject.entries%2CObject.values%2CElement.prototype.dataset%2CString.prototype.replaceAll';\n\nconst GENERIC_TRUE_VALUES = ['true', 'True', 'TRUE', 't', 'T', '1'];\nconst GENERIC_FALSE_VALUES = ['false', 'False', 'FALSE', 'f', 'F', '0'];\n\nconst SAMESITE_COOKIE_OPTS = ['Lax', 'None', 'Strict'];\n\nconst DEFAULT_SESSION_TIMEOUT = 30 * 60 * 1000; // 30 min in milliseconds\nconst MIN_SESSION_TIMEOUT = 10 * 1000; // 10 sec in milliseconds\nconst MIN_SESSION_ID_LENGTH = 10;\n\nconst ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME = 'errorReporting';\nconst LOAD_ORIGIN = 'RS_JS_SDK';\n\nconst DEFAULT_REGION = 'US';\nconst DEFAULT_DATAPLANE_URL = 'https://hosted.rudderlabs.com';\n\nconst RESIDENCY_SERVERS = [DEFAULT_REGION, 'EU'];\n\nconst SUPPORTED_CONSENT_MANAGERS = ['oneTrust'];\n\nconst SYSTEM_KEYWORDS = ['library', 'consentManagement'];\nconst UA_CH_LEVELS = ['none', 'default', 'full'];\n\nexport {\n  RESERVED_KEYS,\n  CONFIG_URL,\n  SDK_CDN_BASE_URL,\n  CDN_ARCH_VERSION_DIR,\n  CDN_INT_DIR,\n  DEST_SDK_BASE_URL,\n  MAX_WAIT_FOR_INTEGRATION_LOAD,\n  INTEGRATION_LOAD_CHECK_INTERVAL,\n  INTG_SUFFIX,\n  POLYFILL_URL,\n  GENERIC_TRUE_VALUES,\n  GENERIC_FALSE_VALUES,\n  SAMESITE_COOKIE_OPTS,\n  DEFAULT_SESSION_TIMEOUT,\n  MIN_SESSION_TIMEOUT,\n  MIN_SESSION_ID_LENGTH,\n  ERROR_REPORTING_SERVICE_GLOBAL_KEY_NAME,\n  LOAD_ORIGIN,\n  DEFAULT_REGION,\n  DEFAULT_DATAPLANE_URL,\n  RESIDENCY_SERVERS,\n  SUPPORTED_CONSENT_MANAGERS,\n  SYSTEM_KEYWORDS,\n  UA_CH_LEVELS,\n};\n","/* eslint-disable no-use-before-define */\n// import logger from \"../utils/logUtil\";\n\nimport { handleError } from \"./errorHandler\";\n\nconst defaultAsyncState = true;\n\nexport const LOAD_ORIGIN = 'RS_JS_SDK';\n/**\n * Script loader\n * @param {String} id                               Id of the script\n * @param {String} src                              URL of the script\n * @param {Object} options                          Object containing different configuration\n * @param {Boolean} options.async                   Determines script will be loaded asynchronously or not\n * @param {Boolean} options.isNonNativeSDK          Determines whether the script that will be loaded is one of RS's own\n * @param {Boolean} options.skipDatasetAttributes   Determines whether to add or skip dataset attribute\n */\nconst ScriptLoader = (id, src, options = {}) => {\n  try {\n    const exists = document.getElementById(id);\n    if (exists) {\n      // logger.debug(\"script already loaded\");\n      return;\n    }\n\n    const js = document.createElement('script');\n    js.src = src;\n    js.async = options.async === undefined ? defaultAsyncState : options.async;\n    js.type = 'text/javascript';\n    js.id = id;\n    // This checking is in place to skip the dataset attribute for some cases(while loading polyfill)\n    if (options.skipDatasetAttributes !== true) {\n      js.setAttribute('data-loader', LOAD_ORIGIN);\n      if (options.isNonNativeSDK !== undefined) {\n        js.setAttribute('data-isNonNativeSDK', options.isNonNativeSDK);\n      }\n    }\n    const headElmColl = document.getElementsByTagName('head');\n    if (headElmColl.length > 0) {\n      // logger.debug(\"==adding script==\", js);\n      headElmColl[0].insertBefore(js, headElmColl[0].firstChild);\n    } else {\n      const e = document.getElementsByTagName('script')[0];\n      // logger.debug(\"==parent script==\", e);\n      // logger.debug(\"==adding script==\", js);\n      e.parentNode.insertBefore(js, e);\n    }\n  } catch (e) {\n    handleError(e);\n  }\n};\n\nexport default ScriptLoader;\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","/*!\n * get-value <https://github.com/jonschlinkert/get-value>\n *\n * Copyright (c) 2014-2018, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nconst isObject = require('isobject');\n\nmodule.exports = function(target, path, options) {\n  if (!isObject(options)) {\n    options = { default: options };\n  }\n\n  if (!isValidObject(target)) {\n    return typeof options.default !== 'undefined' ? options.default : target;\n  }\n\n  if (typeof path === 'number') {\n    path = String(path);\n  }\n\n  const isArray = Array.isArray(path);\n  const isString = typeof path === 'string';\n  const splitChar = options.separator || '.';\n  const joinChar = options.joinChar || (typeof splitChar === 'string' ? splitChar : '.');\n\n  if (!isString && !isArray) {\n    return target;\n  }\n\n  if (isString && path in target) {\n    return isValid(path, target, options) ? target[path] : options.default;\n  }\n\n  let segs = isArray ? path : split(path, splitChar, options);\n  let len = segs.length;\n  let idx = 0;\n\n  do {\n    let prop = segs[idx];\n    if (typeof prop === 'number') {\n      prop = String(prop);\n    }\n\n    while (prop && prop.slice(-1) === '\\\\') {\n      prop = join([prop.slice(0, -1), segs[++idx] || ''], joinChar, options);\n    }\n\n    if (prop in target) {\n      if (!isValid(prop, target, options)) {\n        return options.default;\n      }\n\n      target = target[prop];\n    } else {\n      let hasProp = false;\n      let n = idx + 1;\n\n      while (n < len) {\n        prop = join([prop, segs[n++]], joinChar, options);\n\n        if ((hasProp = prop in target)) {\n          if (!isValid(prop, target, options)) {\n            return options.default;\n          }\n\n          target = target[prop];\n          idx = n - 1;\n          break;\n        }\n      }\n\n      if (!hasProp) {\n        return options.default;\n      }\n    }\n  } while (++idx < len && isValidObject(target));\n\n  if (idx === len) {\n    return target;\n  }\n\n  return options.default;\n};\n\nfunction join(segs, joinChar, options) {\n  if (typeof options.join === 'function') {\n    return options.join(segs);\n  }\n  return segs[0] + joinChar + segs[1];\n}\n\nfunction split(path, splitChar, options) {\n  if (typeof options.split === 'function') {\n    return options.split(path);\n  }\n  return path.split(splitChar);\n}\n\nfunction isValid(key, target, options) {\n  if (typeof options.isValid === 'function') {\n    return options.isValid(key, target);\n  }\n  return true;\n}\n\nfunction isValidObject(val) {\n  return isObject(val) || Array.isArray(val) || typeof val === 'function';\n}\n","/* eslint-disable no-underscore-dangle */\nimport get from 'get-value';\nimport { NAME } from './constants';\n\n/*\n * Here, we are iterating each key-value pair of object 'Obj' and\n * checks if typeof value is string then we pass it as custom variable in mouseflow.\n */\nconst setCustomVariables = (userProperties) => {\n  if (userProperties && typeof userProperties === 'object') {\n    Object.entries(userProperties).forEach((item) => {\n      const [key, value] = item;\n      if (typeof value === 'string' || typeof value === 'number')\n        window._mfq.push(['setVariable', key, value]);\n    });\n  }\n};\n\n/*\n * Set custom Variables from integrations Object\n */\nconst addCustomVariables = (message) => {\n  const customVariables = get(message, `integrations.${NAME}.customVariables`);\n  setCustomVariables(customVariables);\n};\n\nexport { setCustomVariables, addCustomVariables };\n","/* eslint-disable no-underscore-dangle */\n/* eslint-disable class-methods-use-this */\nimport { NAME } from './constants';\nimport logger from '../../utils/logUtil';\nimport ScriptLoader from '../../utils/ScriptLoader';\nimport { setCustomVariables, addCustomVariables } from './utils';\n\nclass Mouseflow {\n  constructor(config, analytics, destinationInfo) {\n    this.websiteId = config.websiteId;\n    this.name = NAME;\n    this.areTransformationsConnected = destinationInfo && destinationInfo.areTransformationsConnected;\n    this.destinationId = destinationInfo && destinationInfo.destinationId;\n  }\n\n  init() {\n    logger.debug('===In init mouseflow===');\n    window._mfq = window._mfq || [];\n    ScriptLoader(\n      'mouseflow-integration',\n      `https://cdn.mouseflow.com/projects/${this.websiteId}.js`,\n    );\n  }\n\n  isLoaded() {\n    logger.debug('===In isLoaded mouseflow===');\n    return !!window.mouseflow && typeof window.mouseflow === 'object';\n  }\n\n  isReady() {\n    logger.debug('===In isReady mouseflow===');\n    return !!window._mfq;\n  }\n\n  /**\n   * Identify.\n   * for supporting userId or email\n   * Ref: https://js-api-docs.mouseflow.com/#identifying-a-user\n   * for supporting user traits and customVariables\n   * Ref: https://js-api-docs.mouseflow.com/#setting-a-custom-variable\n   * @param {Identify} identify\n   */\n  identify(rudderElement) {\n    logger.debug('===In mouseflow Identify===');\n    const { message } = rudderElement;\n    const { traits } = message.context;\n    const email = message.context.traits?.email || message.traits?.email;\n    const userId = message.userId || email || message.anonymousId;\n    window._mfq.push(['stop']);\n    if (userId) window.mouseflow.identify(userId);\n    window.mouseflow.start();\n    setCustomVariables(traits);\n    addCustomVariables(message);\n  }\n\n  /**\n   * Track - tracks an event for a specific user\n   * for supporting event\n   * Ref: https://js-api-docs.mouseflow.com/#tagging-a-recording\n   * for supporting properties and customVariables\n   * Ref: https://js-api-docs.mouseflow.com/#setting-a-custom-variable\n   * @param {Track} track\n   */\n  track(rudderElement) {\n    logger.debug('===In mouseflow Track===');\n    const { message } = rudderElement;\n    const { event, properties } = message;\n    if (!event) {\n      logger.error('[mouseflow]: Event name from track call is missing!!===');\n      return;\n    }\n    window._mfq.push(['tag', event]);\n    setCustomVariables(properties);\n    addCustomVariables(message);\n  }\n\n  /**\n   * Page.\n   * for supporting path of Page\n   * Ref: https://js-api-docs.mouseflow.com/#setting-a-virtual-path\n   * @param {Page} page\n   */\n  page(rudderElement) {\n    logger.debug('===In mouseflow Page===');\n    const tabPath = rudderElement.message.properties.path || rudderElement.message.context.path;\n    if (tabPath) window._mfq.push(['newPageView', tabPath]);\n  }\n}\n\nexport default Mouseflow;\n"],"names":["_CNameMapping","NAME","_defineProperty","LOG_LEVEL","logger","_console2","console","log","apply","arguments","_console4","error","notifyError","errorReportingClient","window","rudderanalytics","notify","handleError","customMessage","analyticsInstance","errorMessage","Error","message","JSON","stringify","e","Event","target","localName","dataset","loader","isNonNativeSDK","src","id","page","path","title","sendAdblockPageOptions","customErrMessagePrefix","normaliseError","err","errorObj","LOAD_ORIGIN","val","_typeof","Array","isArray","segs","joinChar","options","join","isValid","key","isValidObject","isObject","setCustomVariables","userProperties","Object","entries","forEach","item","_item","value","_mfq","push","addCustomVariables","customVariables","default","String","isString","splitChar","separator","split","len","length","idx","prop","slice","hasProp","n","get","concat","Mouseflow","config","analytics","destinationInfo","_classCallCheck","this","websiteId","name","areTransformationsConnected","destinationId","document","getElementById","js","createElement","async","undefined","type","skipDatasetAttributes","setAttribute","headElmColl","getElementsByTagName","insertBefore","firstChild","parentNode","ScriptLoader","mouseflow","rudderElement","traits","context","email","_message$context$trai","_message$traits","userId","anonymousId","identify","start","event","properties","tabPath"],"mappings":"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"}