var Keen_RS=function(e){"use strict";function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function r(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n.apply(this,arguments)}function i(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=4,o=function(e){switch(e.toUpperCase()){case"INFO":a=1;break;case"DEBUG":a=2;break;case"WARN":a=3;break;default:a=4}},s=function(){var e;a<=2&&(e=console).log.apply(e,arguments)},u=function(){var e;a<=4&&(e=console).error.apply(e,arguments)};function c(e){var t=window.rudderanalytics&&window.rudderanalytics.errorReporting;t&&t.notify(e)}function d(e,t,r){var n;try{n=function(e,t,r){var n;try{n="string"==typeof e?e:e instanceof Error||e.message?e.message:JSON.stringify(e)}catch(e){n=""}if(e instanceof Event){if(e.target&&"script"!==e.target.localName)return"";if(e.target.dataset&&("RS_JS_SDK"!==e.target.dataset.loader||"true"!==e.target.dataset.isNonNativeSDK))return"";if(n="error in script loading:: src::  ".concat(e.target.src," id:: ").concat(e.target.id),"ad-block"===e.target.id)return r.page("RudderJS-Initiated","ad-block page request",{path:"/ad-blocked",title:n},r.sendAdblockPageOptions),""}return"[handleError]::".concat(t||"",' "').concat(n,'"')}(e,t,r)}catch(t){u("[handleError] Exception:: ",t),u("[handleError] Original error:: ",JSON.stringify(e)),c(t)}if(n){u(n);var i=e;e instanceof Error||(i=new Error(n)),c(i)}}var l,p="RS_JS_SDK",f="KEEN";r(l={},f,f),r(l,"Keen",f),r(l,"Keen.io",f),r(l,"keen",f),r(l,"keen.io",f);var g=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.logLevel&&o(r.logLevel),this.projectID=t.projectID,this.writeKey=t.writeKey,this.ipAddon=t.ipAddon,this.uaAddon=t.uaAddon,this.urlAddon=t.urlAddon,this.referrerAddon=t.referrerAddon,this.client=null,this.name=f,this.areTransformationsConnected=n&&n.areTransformationsConnected,this.destinationId=n&&n.destinationId}var r,i,a;return r=e,i=[{key:"init",value:function(){s("===in init Keen==="),function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(document.getElementById(e))return;var n=document.createElement("script");n.src=t,n.async=void 0===r.async||r.async,n.type="text/javascript",n.id=e,!0!==r.skipDatasetAttributes&&(n.setAttribute("data-loader",p),void 0!==r.isNonNativeSDK&&n.setAttribute("data-isNonNativeSDK",r.isNonNativeSDK));var i=document.getElementsByTagName("head");if(i.length>0)i[0].insertBefore(n,i[0].firstChild);else{var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a)}}catch(a){d(a)}}("keen-integration","https://cdn.jsdelivr.net/npm/keen-tracking@4");var e=setInterval(function(){var t;void 0!==window.KeenTracking&&void 0!==window.KeenTracking&&(this.client=((t=this).client=new window.KeenTracking({projectId:t.projectID,writeKey:t.writeKey}),t.client),clearInterval(e))}.bind(this),1e3)}},{key:"identify",value:function(e){s("in Keen identify");var t=e.message.context.traits,r=e.message.userId?e.message.userId:e.message.anonymousId,i=e.message.properties?n(i,e.message.properties):{};i.user={userId:r,traits:t},i=this.getAddOn(i),this.client.extendEvents(i)}},{key:"track",value:function(e){s("in Keen track");var t=e.message.event,r=e.message.properties;r=this.getAddOn(r),this.client.recordEvent(t,r)}},{key:"page",value:function(e){s("in Keen page");var t=e.message.name,r=e.message.properties?e.message.properties.category:void 0,n="Loaded a Page";t&&(n="Viewed ".concat(t," page")),r&&t&&(n="Viewed ".concat(r," ").concat(t," page"));var i=e.message.properties;i=this.getAddOn(i),this.client.recordEvent(n,i)}},{key:"isLoaded",value:function(){return s("in Keen isLoaded"),!(null==this.client)}},{key:"isReady",value:function(){return!(null==this.client)}},{key:"getAddOn",value:function(e){var t=[];return this.ipAddon&&(e.ip_address="${keen.ip}",t.push({name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_geo_info"})),this.uaAddon&&(e.user_agent="${keen.user_agent}",t.push({name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"parsed_user_agent"})),this.urlAddon&&(e.page_url=document.location.href,t.push({name:"keen:url_parser",input:{url:"page_url"},output:"parsed_page_url"})),this.referrerAddon&&(e.page_url=document.location.href,e.referrer_url=document.referrer,t.push({name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_info"})),e.keen={addons:t},e}}],i&&t(r.prototype,i),a&&t(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();return e.Keen=g,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=Keen.min.js.map
