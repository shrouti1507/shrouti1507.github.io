{"version":3,"file":"Woopra.min.js","sources":["../../../src/utils/logUtil.js","../../../src/integrations/Woopra/constants.js","../../../src/utils/ScriptLoader.js","../../../src/integrations/Woopra/browser.js"],"sourcesContent":["const LOG_LEVEL_INFO = 1;\nconst LOG_LEVEL_DEBUG = 2;\nconst LOG_LEVEL_WARN = 3;\nconst LOG_LEVEL_ERROR = 4;\nconst DEF_LOG_LEVEL = LOG_LEVEL_ERROR;\nlet LOG_LEVEL = DEF_LOG_LEVEL;\n\nconst logger = {\n  setLogLevel(logLevel) {\n    switch (logLevel.toUpperCase()) {\n      case 'INFO':\n        LOG_LEVEL = LOG_LEVEL_INFO;\n        break;\n      case 'DEBUG':\n        LOG_LEVEL = LOG_LEVEL_DEBUG;\n        break;\n      case 'WARN':\n        LOG_LEVEL = LOG_LEVEL_WARN;\n        break;\n      default:\n        LOG_LEVEL = DEF_LOG_LEVEL;\n        break;\n    }\n  },\n\n  info(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_INFO) {\n      console.info(...args);\n    }\n  },\n\n  debug(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_DEBUG) {\n      console.log(...args);\n    }\n  },\n\n  warn(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_WARN) {\n      console.warn(...args);\n    }\n  },\n\n  error(...args) {\n    if (LOG_LEVEL <= LOG_LEVEL_ERROR) {\n      console.error(...args);\n    }\n  },\n};\n\nexport default logger;\n","const NAME = 'WOOPRA';\nconst CNameMapping = {\n  [NAME]: NAME,\n  Woopra: NAME,\n  woopra: NAME,\n};\n\nexport { NAME, CNameMapping };\n","/* eslint-disable no-use-before-define */\n// import logger from \"../utils/logUtil\";\n\nimport { handleError } from \"./errorHandler\";\n\nconst defaultAsyncState = true;\n\nexport const LOAD_ORIGIN = 'RS_JS_SDK';\n/**\n * Script loader\n * @param {String} id                               Id of the script\n * @param {String} src                              URL of the script\n * @param {Object} options                          Object containing different configuration\n * @param {Boolean} options.async                   Determines script will be loaded asynchronously or not\n * @param {Boolean} options.isNonNativeSDK          Determines whether the script that will be loaded is one of RS's own\n * @param {Boolean} options.skipDatasetAttributes   Determines whether to add or skip dataset attribute\n */\nconst ScriptLoader = (id, src, options = {}) => {\n  try {\n    const exists = document.getElementById(id);\n    if (exists) {\n      // logger.debug(\"script already loaded\");\n      return;\n    }\n\n    const js = document.createElement('script');\n    js.src = src;\n    js.async = options.async === undefined ? defaultAsyncState : options.async;\n    js.type = 'text/javascript';\n    js.id = id;\n    // This checking is in place to skip the dataset attribute for some cases(while loading polyfill)\n    if (options.skipDatasetAttributes !== true) {\n      js.setAttribute('data-loader', LOAD_ORIGIN);\n      if (options.isNonNativeSDK !== undefined) {\n        js.setAttribute('data-isNonNativeSDK', options.isNonNativeSDK);\n      }\n    }\n    const headElmColl = document.getElementsByTagName('head');\n    if (headElmColl.length > 0) {\n      // logger.debug(\"==adding script==\", js);\n      headElmColl[0].insertBefore(js, headElmColl[0].firstChild);\n    } else {\n      const e = document.getElementsByTagName('script')[0];\n      // logger.debug(\"==parent script==\", e);\n      // logger.debug(\"==adding script==\", js);\n      e.parentNode.insertBefore(js, e);\n    }\n  } catch (e) {\n    handleError(e);\n  }\n};\n\nexport default ScriptLoader;\n","/* eslint-disable*/\n/* eslint-disable no-unused-expressions */\n/* eslint-disable no-underscore-dangle */\n/* eslint-disable class-methods-use-this */\nimport logger from '../../utils/logUtil';\n\nimport { NAME } from './constants';\nimport { LOAD_ORIGIN } from '../../utils/ScriptLoader';\n\nclass Woopra {\n  constructor(config, analytics, destinationInfo) {\n    if (analytics.logLevel) logger.setLogLevel(analytics.logLevel);\n    this.projectName = config.projectName;\n    this.name = NAME;\n    this.cookieName = config.cookieName;\n    this.cookiePath = config.cookiePath;\n    this.cookieDomain = config.cookieDomain;\n    this.clickTracking = config.clickTracking;\n    this.downloadTracking = config.downloadTracking;\n    this.hideCampaign = config.hideCampaign;\n    this.idleTimeout = config.idleTimeout;\n    this.ignoreQueryUrl = config.ignoreQueryUrl;\n    this.outgoingIgnoreSubdomain = config.outgoingIgnoreSubdomain;\n    this.outgoingTracking = config.outgoingTracking;\n    this.areTransformationsConnected = destinationInfo && destinationInfo.areTransformationsConnected;\n    this.destinationId = destinationInfo && destinationInfo.destinationId;\n  }\n\n  init() {\n    logger.debug('===In init Woopra===');\n    !(function () {\n      var t,\n        o,\n        c,\n        e = window,\n        n = document,\n        r = arguments,\n        a = 'script',\n        i = [\n          'call',\n          'cancelAction',\n          'config',\n          'identify',\n          'push',\n          'track',\n          'trackClick',\n          'trackForm',\n          'update',\n          'visit',\n        ],\n        s = function () {\n          var t,\n            o = this,\n            c = function (t) {\n              o[t] = function () {\n                return o._e.push([t].concat(Array.prototype.slice.call(arguments, 0))), o;\n              };\n            };\n          for (o._e = [], t = 0; t < i.length; t++) c(i[t]);\n        };\n      for (e.__woo = e.__woo || {}, t = 0; t < r.length; t++)\n        e.__woo[r[t]] = e[r[t]] = e[r[t]] || new s();\n      ((o = n.createElement(a)).async = 1),\n        (o.src = 'https://static.woopra.com/w.js'),\n        o.setAttribute('data-loader', LOAD_ORIGIN),\n        (c = n.getElementsByTagName(a)[0]).parentNode.insertBefore(o, c);\n    })('Woopra');\n    window.Woopra.config({\n      domain: this.projectName,\n      cookie_name: this.cookieName,\n      cookie_path: this.cookiePath,\n      cookie_domain: this.cookieDomain,\n      click_tracking: this.clickTracking,\n      download_tracking: this.downloadTracking,\n      hide_campaign: this.hideCampaign,\n      idle_timeout: this.idleTimeout,\n      ignore_query_url: this.ignoreQueryUrl,\n      outgoing_ignore_subdomain: this.outgoingIgnoreSubdomain,\n      outgoing_tracking: this.outgoingTracking,\n    });\n  }\n\n  isLoaded() {\n    logger.debug('===In isLoaded Woopra===');\n    return !!(window.Woopra && window.Woopra.loaded);\n  }\n\n  isReady() {\n    logger.debug('===In isReady Woopra===');\n    return !!window.Woopra;\n  }\n\n  identify(rudderElement) {\n    logger.debug('===In Woopra Identify===');\n    const { traits } = rudderElement.message.context;\n    if (traits) {\n      window.Woopra.identify(traits).push();\n    }\n  }\n\n  track(rudderElement) {\n    logger.debug('===In Woopra Track===');\n    const { event, properties } = rudderElement.message;\n    window.Woopra.track(event, properties);\n  }\n\n  page(rudderElement) {\n    logger.debug('===In Woopra Page ===');\n    const { name, properties, category } = rudderElement.message;\n    const pageCat = category ? `${category} ` : '';\n    const pageName = name ? `${name} ` : '';\n    const eventName = `Viewed ${pageCat}${pageName}Page`;\n    window.Woopra.track(eventName, properties);\n  }\n}\n\nexport default Woopra;\n"],"names":["_CNameMapping","LOG_LEVEL","logger","logLevel","toUpperCase","_console2","console","log","apply","arguments","NAME","_defineProperty","LOAD_ORIGIN","Woopra","config","analytics","destinationInfo","_classCallCheck","this","projectName","name","cookieName","cookiePath","cookieDomain","clickTracking","downloadTracking","hideCampaign","idleTimeout","ignoreQueryUrl","outgoingIgnoreSubdomain","outgoingTracking","areTransformationsConnected","destinationId","key","value","t","o","c","e","window","n","document","r","a","i","s","_e","push","concat","Array","prototype","slice","call","length","__woo","createElement","async","src","setAttribute","getElementsByTagName","parentNode","insertBefore","domain","cookie_name","cookie_path","cookie_domain","click_tracking","download_tracking","hide_campaign","idle_timeout","ignore_query_url","outgoing_ignore_subdomain","outgoing_tracking","loaded","rudderElement","traits","message","context","identify","_rudderElement$messag","event","properties","track","_rudderElement$messag2","category","pageCat","pageName","eventName"],"mappings":"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"}